# –ü–õ–ê–ù –†–ï–§–ê–ö–¢–û–†–ò–ù–ì–ê –ü–†–û–ï–ö–¢–ê
## Lucky E2E Automation - –ü–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω —É–ª—É—á—à–µ–Ω–∏–π

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2024-12-19  
**–ê–≤—Ç–æ—Ä:** Head of AQA  
**–í–µ—Ä—Å–∏—è –ø–ª–∞–Ω–∞:** 1.0  
**–¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è:** Senior AQA Engineers  

---

## EXECUTIVE SUMMARY

–î–∞–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç **–ø–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞** –ø—Ä–æ–µ–∫—Ç–∞ Lucky E2E Automation, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –Ω–∞ —É–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

### –ö–ª—é—á–µ–≤—ã–µ —Ü–µ–ª–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:
- üöÄ **–£–≤–µ–ª–∏—á–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** –Ω–∞ 60%
- üéØ **–ü–æ–≤—ã—Å–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å** —Ç–µ—Å—Ç–æ–≤ –¥–æ 95%
- üìà **–£–ª—É—á—à–∏—Ç—å –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** –¥–ª—è –∫–æ–º–∞–Ω–¥—ã –¥–æ 10 —á–µ–ª–æ–≤–µ–∫
- üîß **–£–ø—Ä–æ—Å—Ç–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É** –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤

---

## –§–ê–ó–ê 1: –ë–ê–ó–û–í–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø (–ù–ï–î–ï–õ–Ø 1-2)

### 1.1. –†–ï–°–¢–†–£–ö–¢–£–†–ò–ó–ê–¶–ò–Ø –ü–ê–ü–û–ö –ò –§–ê–ô–õ–û–í

#### –¶–µ–ª—å: –£–ª—É—á—à–∏—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏—é –∏ –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞

#### 1.1.1. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–∞–ø–æ–∫

**–¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
src/
‚îú‚îÄ‚îÄ core/
‚îú‚îÄ‚îÄ components/
‚îú‚îÄ‚îÄ services/
‚îú‚îÄ‚îÄ pages/
‚îî‚îÄ‚îÄ types/
```

**–¶–µ–ª–µ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
src/
‚îú‚îÄ‚îÄ core/                    # –ë–∞–∑–æ–≤—ã–µ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ abstract/           # –ê–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ –∫–ª–∞—Å—Å—ã
‚îÇ   ‚îú‚îÄ‚îÄ interfaces/         # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
‚îÇ   ‚îú‚îÄ‚îÄ factories/          # –§–∞–±—Ä–∏–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ decorators/         # –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã
‚îÇ   ‚îî‚îÄ‚îÄ utils/              # –£—Ç–∏–ª–∏—Ç—ã
‚îú‚îÄ‚îÄ components/             # UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ atoms/              # –ê—Ç–æ–º–∞—Ä–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ molecules/          # –ú–æ–ª–µ–∫—É–ª—è—Ä–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ organisms/          # –û—Ä–≥–∞–Ω–∏–∑–º–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ templates/          # –®–∞–±–ª–æ–Ω—ã —Å—Ç—Ä–∞–Ω–∏—Ü
‚îú‚îÄ‚îÄ services/               # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ domain/             # –î–æ–º–µ–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
‚îÇ   ‚îú‚îÄ‚îÄ infrastructure/     # –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
‚îÇ   ‚îî‚îÄ‚îÄ application/        # –°–µ—Ä–≤–∏—Å—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ pages/                  # Page Objects
‚îú‚îÄ‚îÄ types/                  # TypeScript —Ç–∏–ø—ã
‚îú‚îÄ‚îÄ config/                 # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ utils/                  # –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã
‚îú‚îÄ‚îÄ docs/                   # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ examples/               # –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
‚îî‚îÄ‚îÄ templates/              # –®–∞–±–ª–æ–Ω—ã –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤
```

#### 1.1.2. –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –°–æ–∑–¥–∞—Ç—å `docs/architecture/` —Å –¥–∏–∞–≥—Ä–∞–º–º–∞–º–∏
2. –î–æ–±–∞–≤–∏—Ç—å `docs/guides/` —Å —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞–º–∏
3. –°–æ–∑–¥–∞—Ç—å `docs/examples/` —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏
4. –î–æ–±–∞–≤–∏—Ç—å `README.md` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–æ–¥—É–ª—è

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
docs/
‚îú‚îÄ‚îÄ architecture/
‚îÇ   ‚îú‚îÄ‚îÄ system-overview.md
‚îÇ   ‚îú‚îÄ‚îÄ component-diagram.md
‚îÇ   ‚îî‚îÄ‚îÄ data-flow.md
‚îú‚îÄ‚îÄ guides/
‚îÇ   ‚îú‚îÄ‚îÄ getting-started.md
‚îÇ   ‚îú‚îÄ‚îÄ adding-new-tests.md
‚îÇ   ‚îî‚îÄ‚îÄ debugging-guide.md
‚îî‚îÄ‚îÄ examples/
    ‚îú‚îÄ‚îÄ basic-test-example.ts
    ‚îú‚îÄ‚îÄ component-test-example.ts
    ‚îî‚îÄ‚îÄ service-test-example.ts
```

### 1.2. –°–¢–ê–ù–î–ê–†–¢–ò–ó–ê–¶–ò–Ø CODE STYLE

#### –¶–µ–ª—å: –û–±–µ—Å–ø–µ—á–∏—Ç—å –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ –∫–æ–¥–∞

#### 1.2.1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ ESLint

**–°–æ–∑–¥–∞—Ç—å `.eslintrc.js`:**
```javascript
module.exports = {
  extends: [
    '@typescript-eslint/recommended',
    'plugin:playwright/recommended',
    'prettier'
  ],
  parser: '@typescript-eslint/parser',
  plugins: ['@typescript-eslint', 'playwright'],
  rules: {
    // Playwright specific rules
    'playwright/missing-playwright-await': 'error',
    'playwright/no-useless-not': 'error',
    'playwright/prefer-lowercase-title': 'error',
    'playwright/prefer-strict-equal': 'error',
    
    // TypeScript rules
    '@typescript-eslint/no-unused-vars': 'error',
    '@typescript-eslint/explicit-function-return-type': 'warn',
    '@typescript-eslint/no-explicit-any': 'error',
    
    // General rules
    'no-console': 'warn',
    'prefer-const': 'error',
    'no-var': 'error'
  },
  env: {
    node: true,
    es2020: true
  }
};
```

#### 1.2.2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Prettier

**–°–æ–∑–¥–∞—Ç—å `.prettierrc`:**
```json
{
  "semi": true,
  "trailingComma": "es5",
  "singleQuote": true,
  "printWidth": 100,
  "tabWidth": 2,
  "useTabs": false,
  "bracketSpacing": true,
  "arrowParens": "avoid"
}
```

#### 1.2.3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Pre-commit Hooks

**–°–æ–∑–¥–∞—Ç—å `.husky/pre-commit`:**
```bash
#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

npm run lint:fix
npm run format
npm run type-check
```

### 1.3. –ë–ê–ó–û–í–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø –ß–ò–¢–ê–ï–ú–û–°–¢–ò

#### –¶–µ–ª—å: –£–ø—Ä–æ—Å—Ç–∏—Ç—å –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∫–æ–¥–∞

#### 1.3.1. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ JSDoc –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤

**–ü—Ä–∏–º–µ—Ä –¥–ª—è BaseService:**
```typescript
/**
 * –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
 * –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ–±—â—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ä–∞–±–æ—Ç—ã —Å Page
 * 
 * @abstract
 * @example
 * ```typescript
 * class MyService extends BaseService {
 *   constructor(page: Page, loggerInstance?: ILogger) {
 *     super(page, 'MyService', loggerInstance);
 *   }
 * }
 * ```
 */
export abstract class BaseService {
  /**
   * –°–æ–∑–¥–∞–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä BaseService
   * 
   * @param page - –≠–∫–∑–µ–º–ø–ª—è—Ä Playwright Page
   * @param componentName - –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
   * @param loggerInstance - –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –ª–æ–≥–≥–µ—Ä–∞
   */
  constructor(
    protected readonly page: Page,
    protected readonly componentName: string,
    protected readonly logger: ILogger = logger
  ) {}

  /**
   * –õ–æ–≥–∏—Ä—É–µ—Ç —à–∞–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
   * 
   * @param message - –°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
   * @example
   * ```typescript
   * this.logStep('Opening game page');
   * ```
   */
  protected logStep(message: string): void {
    this.logger.info(this.componentName, message);
  }
}
```

#### 1.3.2. –°–æ–∑–¥–∞–Ω–∏–µ README –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–æ–¥—É–ª—è

**–ü—Ä–∏–º–µ—Ä –¥–ª—è `src/services/game/README.md`:**
```markdown
# Game Services

–ú–æ–¥—É–ª—å —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–µ—Ä–≤–∏—Å—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏–≥—Ä–∞–º–∏ –≤ –∫–∞–∑–∏–Ω–æ.

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### GameOrchestrator
–ì–ª–∞–≤–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ –∏–≥—Ä–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.

### GameDetectionService
–°–µ—Ä–≤–∏—Å –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∏ –ø–æ–∏—Å–∫–∞ –∏–≥—Ä –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ.

### GameInteractionService
–°–µ—Ä–≤–∏—Å –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –∏–≥—Ä–æ–≤—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏.

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```typescript
import { GameServiceFactory } from '@/core/factories/GameServiceFactory';

const gameService = GameServiceFactory.createGameOrchestrator(page);
await gameService.testGameUniversal('Book of Dead', 'Play\'n GO');
```

## –ü—Ä–∏–º–µ—Ä—ã

–°–º. `docs/examples/game-service-example.ts`
```

### 1.4. –ò–ó–ë–ê–í–õ–ï–ù–ò–ï –û–¢ –î–£–ë–õ–ò–ö–ê–¢–û–í –õ–û–ì–ò–ö–ò

#### –¶–µ–ª—å: –£—Å—Ç—Ä–∞–Ω–∏—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞

#### 1.4.1. –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—â–∏—Ö —É—Ç–∏–ª–∏—Ç

**–°–æ–∑–¥–∞—Ç—å `src/utils/test-helpers.ts`:**
```typescript
import { Page, Locator } from '@playwright/test';

export class TestHelpers {
  /**
   * –û–∂–∏–¥–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç —Å –ø–æ–≤—Ç–æ—Ä–Ω—ã–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏
   */
  static async waitForElementWithRetry(
    page: Page,
    selector: string,
    maxRetries: number = 3,
    delay: number = 1000
  ): Promise<Locator> {
    for (let i = 0; i < maxRetries; i++) {
      try {
        await page.waitForSelector(selector, { timeout: 10000 });
        return page.locator(selector);
      } catch (error) {
        if (i === maxRetries - 1) throw error;
        await page.waitForTimeout(delay);
      }
    }
  }

  /**
   * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–∏–¥–∏–º–æ—Å—Ç—å —ç–ª–µ–º–µ–Ω—Ç–∞ —Å —Ç–∞–π–º–∞—É—Ç–æ–º
   */
  static async isElementVisible(
    element: Locator,
    timeout: number = 5000
  ): Promise<boolean> {
    try {
      await element.waitFor({ state: 'visible', timeout });
      return true;
    } catch {
      return false;
    }
  }

  /**
   * –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
   */
  static generateTestData(type: 'email' | 'phone' | 'name'): string {
    const timestamp = Date.now();
    switch (type) {
      case 'email':
        return `test${timestamp}@example.com`;
      case 'phone':
        return `+380${Math.floor(Math.random() * 100000000)}`;
      case 'name':
        return `TestUser${timestamp}`;
      default:
        throw new Error(`Unknown type: ${type}`);
    }
  }
}
```

#### 1.4.2. –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–≤

**–°–æ–∑–¥–∞—Ç—å `src/core/decorators/retry.decorator.ts`:**
```typescript
export function Retry(maxRetries: number = 3, delay: number = 1000) {
  return function (target: any, propertyName: string, descriptor: PropertyDescriptor) {
    const method = descriptor.value;

    descriptor.value = async function (...args: any[]) {
      for (let i = 0; i < maxRetries; i++) {
        try {
          return await method.apply(this, args);
        } catch (error) {
          if (i === maxRetries - 1) throw error;
          await new Promise(resolve => setTimeout(resolve, delay));
        }
      }
    };
  };
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```typescript
export class GameService extends BaseService {
  @Retry(3, 1000)
  async clickGameButton(selector: string): Promise<void> {
    await this.page.click(selector);
  }
}
```

### 1.5. –ß–ï–¢–ö–û–ï –†–ê–ó–î–ï–õ–ï–ù–ò–ï –ò–ï–†–ê–†–•–ò–ò –ò –û–¢–í–ï–¢–°–¢–í–ï–ù–ù–û–°–¢–ò

#### –¶–µ–ª—å: –£–ª—É—á—à–∏—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞

#### 1.5.1. –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

**–°–æ–∑–¥–∞—Ç—å `docs/architecture/system-overview.md`:**
```mermaid
graph TB
    A[Test Layer] --> B[Page Object Layer]
    B --> C[Service Layer]
    C --> D[Core Layer]
    
    A1[Smoke Tests] --> A
    A2[Unit Tests] --> A
    A3[E2E Tests] --> A
    
    B1[Page Objects] --> B
    B2[Components] --> B
    B3[Modals] --> B
    
    C1[Game Services] --> C
    C2[User Services] --> C
    C3[Payment Services] --> C
    
    D1[Base Classes] --> D
    D2[Interfaces] --> D
    D3[Logger] --> D
```

#### 1.5.2. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–µ–π —Å–ª–æ–µ–≤

**–°–æ–∑–¥–∞—Ç—å `docs/architecture/layer-responsibilities.md`:**
```markdown
# –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ —Å–ª–æ–µ–≤

## Test Layer
- –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–∂–∏–¥–∞–µ–º—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

## Page Object Layer
- –ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è UI —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
- –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –æ—Ç –¥–µ—Ç–∞–ª–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

## Service Layer
- –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ª–æ–∂–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## Core Layer
- –ë–∞–∑–æ–≤—ã–µ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏
- –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã
- –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
```

---

## –§–ê–ó–ê 2: –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø (–ù–ï–î–ï–õ–Ø 3-4)

### 2.1. –í–ù–ï–î–†–ï–ù–ò–ï PAGE OBJECT PATTERN

#### –¶–µ–ª—å: –£–ª—É—á—à–∏—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é —Ç–µ—Å—Ç–æ–≤

#### 2.1.1. –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö Page Objects

**–°–æ–∑–¥–∞—Ç—å `src/pages/base/BasePage.ts`:**
```typescript
import { Page, Locator } from '@playwright/test';
import { BaseService } from '@/core/abstract/base-service';
import { ILogger } from '@/core/interfaces/logger.interface';

export abstract class BasePage extends BaseService {
  protected readonly url: string;
  protected readonly pageTitle: string;

  constructor(
    page: Page,
    pageName: string,
    url: string,
    pageTitle?: string,
    loggerInstance?: ILogger
  ) {
    super(page, pageName, loggerInstance);
    this.url = url;
    this.pageTitle = pageTitle || '';
  }

  /**
   * –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
   */
  async navigate(): Promise<void> {
    this.logStep(`Navigating to ${this.url}`);
    await this.page.goto(this.url);
    await this.waitForPageLoad();
    this.logSuccess(`Navigated to ${this.url}`);
  }

  /**
   * –û–∂–∏–¥–∞–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
   */
  async waitForPageLoad(): Promise<void> {
    await this.page.waitForLoadState('domcontentloaded');
    await this.page.waitForLoadState('networkidle');
  }

  /**
   * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –º—ã –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
   */
  async isOnPage(): Promise<boolean> {
    const currentUrl = this.page.url();
    return currentUrl.includes(this.url);
  }

  /**
   * –ü–æ–ª—É—á–∞–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
   */
  async getPageTitle(): Promise<string> {
    return await this.page.title();
  }
}
```

#### 2.1.2. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è Component Object Model

**–°–æ–∑–¥–∞—Ç—å `src/components/base/BaseComponent.ts`:**
```typescript
import { Page, Locator } from '@playwright/test';
import { BaseService } from '@/core/abstract/base-service';
import { ILogger } from '@/core/interfaces/logger.interface';

export abstract class BaseComponent extends BaseService {
  protected readonly baseSelector: string;

  constructor(
    page: Page,
    componentName: string,
    baseSelector: string,
    loggerInstance?: ILogger
  ) {
    super(page, componentName, loggerInstance);
    this.baseSelector = baseSelector;
  }

  /**
   * –ü–æ–ª—É—á–∞–µ—Ç –∫–æ—Ä–Ω–µ–≤–æ–π —ç–ª–µ–º–µ–Ω—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
   */
  get rootElement(): Locator {
    return this.page.locator(this.baseSelector);
  }

  /**
   * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–∏–¥–∏–º–æ—Å—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
   */
  async isVisible(): Promise<boolean> {
    return await this.rootElement.isVisible();
  }

  /**
   * –û–∂–∏–¥–∞–µ—Ç –ø–æ—è–≤–ª–µ–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
   */
  async waitForVisible(timeout: number = 10000): Promise<void> {
    await this.rootElement.waitFor({ state: 'visible', timeout });
  }

  /**
   * –ö–ª–∏–∫–∞–µ—Ç –ø–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É
   */
  async click(): Promise<void> {
    this.logStep(`Clicking ${this.componentName}`);
    await this.rootElement.click();
    this.logSuccess(`Clicked ${this.componentName}`);
  }
}
```

#### 2.1.3. –°–æ–∑–¥–∞–Ω–∏–µ Page Factory

**–°–æ–∑–¥–∞—Ç—å `src/core/factories/PageFactory.ts`:**
```typescript
import { Page } from '@playwright/test';
import { BasePage } from '@/pages/base/BasePage';
import { GamePage } from '@/pages/GamePage';
import { UserPage } from '@/pages/UserPage';
import { PaymentPage } from '@/pages/PaymentPage';

export enum PageType {
  GAME = 'game',
  USER = 'user',
  PAYMENT = 'payment'
}

export class PageFactory {
  static createPage(page: Page, pageType: PageType): BasePage {
    switch (pageType) {
      case PageType.GAME:
        return new GamePage(page);
      case PageType.USER:
        return new UserPage(page);
      case PageType.PAYMENT:
        return new PaymentPage(page);
      default:
        throw new Error(`Unknown page type: ${pageType}`);
    }
  }
}
```

### 2.2. –£–õ–£–ß–®–ï–ù–ò–ï –£–ü–†–ê–í–õ–ï–ù–ò–Ø –°–û–°–¢–û–Ø–ù–ò–ï–ú

#### –¶–µ–ª—å: –°–¥–µ–ª–∞—Ç—å —Ç–µ—Å—Ç—ã –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–º–∏

#### 2.2.1. –°–æ–∑–¥–∞–Ω–∏–µ State Manager

**–°–æ–∑–¥–∞—Ç—å `src/core/state/StateManager.ts`:**
```typescript
import { Page } from '@playwright/test';
import { ILogger } from '@/core/interfaces/logger.interface';

export interface TestState {
  [key: string]: unknown;
}

export class StateManager {
  private static instance: StateManager;
  private state: TestState = {};
  private page: Page;
  private logger: ILogger;

  private constructor(page: Page, logger: ILogger) {
    this.page = page;
    this.logger = logger;
  }

  static getInstance(page: Page, logger: ILogger): StateManager {
    if (!StateManager.instance) {
      StateManager.instance = new StateManager(page, logger);
    }
    return StateManager.instance;
  }

  /**
   * –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ
   */
  async saveState(key: string, data: unknown): Promise<void> {
    this.logger.info('StateManager', `Saving state: ${key}`);
    this.state[key] = data;
    await this.persistState();
  }

  /**
   * –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ
   */
  async restoreState<T>(key: string): Promise<T | undefined> {
    this.logger.info('StateManager', `Restoring state: ${key}`);
    return this.state[key] as T;
  }

  /**
   * –û—á–∏—â–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ
   */
  async clearState(): Promise<void> {
    this.logger.info('StateManager', 'Clearing state');
    this.state = {};
  }

  /**
   * –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ localStorage
   */
  private async persistState(): Promise<void> {
    await this.page.evaluate((state) => {
      localStorage.setItem('testState', JSON.stringify(state));
    }, this.state);
  }
}
```

#### 2.2.2. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–∞ Memento

**–°–æ–∑–¥–∞—Ç—å `src/core/state/StateMemento.ts`:**
```typescript
export class StateMemento {
  constructor(
    private readonly state: TestState,
    private readonly timestamp: Date
  ) {}

  getState(): TestState {
    return { ...this.state };
  }

  getTimestamp(): Date {
    return this.timestamp;
  }
}

export class StateCaretaker {
  private mementos: StateMemento[] = [];
  private maxMementos: number = 10;

  /**
   * –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–Ω–∏–º–æ–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è
   */
  saveMemento(state: TestState): void {
    const memento = new StateMemento(state, new Date());
    this.mementos.push(memento);

    // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–Ω–∏–º–∫–æ–≤
    if (this.mementos.length > this.maxMementos) {
      this.mementos.shift();
    }
  }

  /**
   * –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–Ω–∏–º–æ–∫
   */
  restoreLastMemento(): StateMemento | undefined {
    return this.mementos.pop();
  }

  /**
   * –ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ —Å–Ω–∏–º–∫–∏
   */
  getAllMementos(): StateMemento[] {
    return [...this.mementos];
  }
}
```

### 2.3. –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò

#### –¶–µ–ª—å: –£–ª—É—á—à–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å

#### 2.3.1. –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π

**–°–æ–∑–¥–∞—Ç—å `src/config/environments/development.ts`:**
```typescript
export const developmentConfig = {
  baseURL: 'https://dev.luckycoin777.live',
  timeout: 30000,
  retries: 1,
  workers: 4,
  fullyParallel: true,
  reporter: [['html'], ['line']],
  use: {
    trace: 'on-first-retry',
    screenshot: 'only-on-failure',
    video: 'retain-on-failure'
  }
};
```

**–°–æ–∑–¥–∞—Ç—å `src/config/environments/production.ts`:**
```typescript
export const productionConfig = {
  baseURL: 'https://luckycoin777.live',
  timeout: 60000,
  retries: 3,
  workers: 2,
  fullyParallel: true,
  reporter: [['html'], ['json'], ['junit']],
  use: {
    trace: 'retain-on-failure',
    screenshot: 'only-on-failure',
    video: 'retain-on-failure'
  }
};
```

#### 2.3.2. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–∞–π–º–∞—É—Ç–æ–≤

**–°–æ–∑–¥–∞—Ç—å `src/core/config/TimeoutManager.ts`:**
```typescript
export class TimeoutManager {
  private static timeouts: Map<string, number> = new Map();

  static setTimeout(key: string, value: number): void {
    this.timeouts.set(key, value);
  }

  static getTimeout(key: string, defaultValue: number = 10000): number {
    return this.timeouts.get(key) || defaultValue;
  }

  static getAdaptiveTimeout(
    baseTimeout: number,
    retryCount: number,
    maxTimeout: number = 60000
  ): number {
    const adaptiveTimeout = baseTimeout * Math.pow(1.5, retryCount);
    return Math.min(adaptiveTimeout, maxTimeout);
  }
}
```

#### 2.3.3. –£–º–Ω–∞—è retry –ª–æ–≥–∏–∫–∞

**–°–æ–∑–¥–∞—Ç—å `src/core/retry/SmartRetry.ts`:**
```typescript
export class SmartRetry {
  static async retryWithBackoff<T>(
    operation: () => Promise<T>,
    maxRetries: number = 3,
    baseDelay: number = 1000,
    backoffMultiplier: number = 2
  ): Promise<T> {
    let lastError: Error;

    for (let attempt = 0; attempt < maxRetries; attempt++) {
      try {
        return await operation();
      } catch (error) {
        lastError = error as Error;

        if (attempt < maxRetries - 1) {
          const delay = baseDelay * Math.pow(backoffMultiplier, attempt);
          await new Promise(resolve => setTimeout(resolve, delay));
        }
      }
    }

    throw lastError!;
  }

  static async retryWithCondition<T>(
    operation: () => Promise<T>,
    condition: (error: Error) => boolean,
    maxRetries: number = 3
  ): Promise<T> {
    let lastError: Error;

    for (let attempt = 0; attempt < maxRetries; attempt++) {
      try {
        return await operation();
      } catch (error) {
        lastError = error as Error;

        if (!condition(lastError) || attempt === maxRetries - 1) {
          throw lastError;
        }

        await new Promise(resolve => setTimeout(resolve, 1000));
      }
    }

    throw lastError!;
  }
}
```

---

## –§–ê–ó–ê 3: –ü–†–û–î–í–ò–ù–£–¢–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø (–ù–ï–î–ï–õ–Ø 5-6)

### 3.1. –í–ù–ï–î–†–ï–ù–ò–ï –†–ï–ü–û–†–¢–ò–ù–ì –°–ò–°–¢–ï–ú–´

#### –¶–µ–ª—å: –£–ª—É—á—à–∏—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

#### 3.1.1. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Allure Report

**–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
```bash
npm install --save-dev allure-playwright allure-commandline
```

**–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:**
```typescript
// playwright.config.ts
import { defineConfig } from '@playwright/test';

export default defineConfig({
  reporter: [
    ['allure-playwright', {
      detail: true,
      outputFolder: 'allure-results',
      suiteTitle: false,
      environmentInfo: {
        NODE_VERSION: process.version,
        PLAYWRIGHT_VERSION: require('@playwright/test/package.json').version
      }
    }],
    ['html', { outputFolder: 'playwright-report' }]
  ]
});
```

#### 3.1.2. –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Ä–µ–ø–æ—Ä—Ç–µ—Ä–æ–≤

**–°–æ–∑–¥–∞—Ç—å `src/reporters/CustomReporter.ts`:**
```typescript
import { FullConfig, FullResult, Reporter, Suite, TestCase, TestResult } from '@playwright/test/reporter';

export class CustomReporter implements Reporter {
  onBegin(config: FullConfig, suite: Suite) {
    console.log(`Starting the run with ${suite.allTests().length} tests`);
  }

  onTestBegin(test: TestCase, result: TestResult) {
    console.log(`Starting test ${test.title}`);
  }

  onTestEnd(test: TestCase, result: TestResult) {
    console.log(`Finished test ${test.title}: ${result.status}`);
  }

  onEnd(result: FullResult) {
    console.log(`Finished the run: ${result.status}`);
  }
}
```

#### 3.1.3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –∫–∞—á–µ—Å—Ç–≤–∞

**–°–æ–∑–¥–∞—Ç—å `src/core/metrics/QualityMetrics.ts`:**
```typescript
export interface QualityMetrics {
  testExecutionTime: number;
  flakyTestCount: number;
  testPassRate: number;
  averageTestDuration: number;
  errorDistribution: Map<string, number>;
}

export class QualityMetricsCollector {
  private metrics: QualityMetrics = {
    testExecutionTime: 0,
    flakyTestCount: 0,
    testPassRate: 0,
    averageTestDuration: 0,
    errorDistribution: new Map()
  };

  recordTestResult(testName: string, duration: number, status: string): void {
    // –õ–æ–≥–∏–∫–∞ —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫
  }

  getMetrics(): QualityMetrics {
    return { ...this.metrics };
  }

  generateReport(): string {
    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞
    return JSON.stringify(this.metrics, null, 2);
  }
}
```

### 3.2. –£–õ–£–ß–®–ï–ù–ò–ï –°–¢–ê–ë–ò–õ–¨–ù–û–°–¢–ò –¢–ï–°–¢–û–í

#### –¶–µ–ª—å: –£—Å—Ç—Ä–∞–Ω–∏—Ç—å flaky tests

#### 3.2.1. –í–Ω–µ–¥—Ä–µ–Ω–∏–µ —É–º–Ω—ã—Ö –æ–∂–∏–¥–∞–Ω–∏–π

**–°–æ–∑–¥–∞—Ç—å `src/core/wait/SmartWait.ts`:**
```typescript
import { Page, Locator } from '@playwright/test';

export class SmartWait {
  static async waitForStableElement(
    page: Page,
    selector: string,
    stabilityTime: number = 2000
  ): Promise<Locator> {
    const element = page.locator(selector);
    let lastPosition = await element.boundingBox();
    let stableTime = 0;

    while (stableTime < stabilityTime) {
      await page.waitForTimeout(100);
      const currentPosition = await element.boundingBox();

      if (JSON.stringify(currentPosition) === JSON.stringify(lastPosition)) {
        stableTime += 100;
      } else {
        stableTime = 0;
        lastPosition = currentPosition;
      }
    }

    return element;
  }

  static async waitForNetworkIdle(page: Page, timeout: number = 30000): Promise<void> {
    await page.waitForLoadState('networkidle', { timeout });
  }

  static async waitForElementToBeStable(
    element: Locator,
    timeout: number = 10000
  ): Promise<void> {
    await element.waitFor({ state: 'visible', timeout });
    
    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
    let isStable = false;
    let attempts = 0;
    const maxAttempts = 10;

    while (!isStable && attempts < maxAttempts) {
      const before = await element.boundingBox();
      await element.page().waitForTimeout(100);
      const after = await element.boundingBox();

      isStable = JSON.stringify(before) === JSON.stringify(after);
      attempts++;
    }
  }
}
```

#### 3.2.2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

**–°–æ–∑–¥–∞—Ç—å `src/core/recovery/AutoRecovery.ts`:**
```typescript
export class AutoRecovery {
  static async recoverFromError(
    page: Page,
    error: Error,
    context: string
  ): Promise<boolean> {
    const errorMessage = error.message.toLowerCase();

    // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫
    if (errorMessage.includes('net::err_')) {
      await page.reload();
      await page.waitForLoadState('networkidle');
      return true;
    }

    // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç –æ—à–∏–±–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏
    if (errorMessage.includes('timeout')) {
      await page.waitForTimeout(2000);
      return true;
    }

    // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç –æ—à–∏–±–æ–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    if (errorMessage.includes('element not found')) {
      await page.waitForTimeout(1000);
      return true;
    }

    return false;
  }

  static async retryWithRecovery<T>(
    operation: () => Promise<T>,
    maxRetries: number = 3,
    page: Page
  ): Promise<T> {
    for (let attempt = 0; attempt < maxRetries; attempt++) {
      try {
        return await operation();
      } catch (error) {
        const recovered = await this.recoverFromError(page, error as Error, 'retry');
        
        if (!recovered || attempt === maxRetries - 1) {
          throw error;
        }
      }
    }

    throw new Error('Max retries exceeded');
  }
}
```

### 3.3. –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò

#### –¶–µ–ª—å: –£—Å–∫–æ—Ä–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤

#### 3.3.1. –í–∫–ª—é—á–µ–Ω–∏–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

**–û–±–Ω–æ–≤–∏—Ç—å `playwright.config.ts`:**
```typescript
export default defineConfig({
  fullyParallel: true,
  workers: process.env.CI ? 2 : 4,
  retries: process.env.CI ? 2 : 1,
  
  // –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
  use: {
    // –û—Ç–∫–ª—é—á–∏—Ç—å –Ω–µ–Ω—É–∂–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è
    trace: 'retain-on-failure',
    screenshot: 'only-on-failure',
    video: 'retain-on-failure'
  }
});
```

#### 3.3.2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤

**–°–æ–∑–¥–∞—Ç—å `src/core/selectors/OptimizedSelectors.ts`:**
```typescript
export class OptimizedSelectors {
  // –ö—ç—à –¥–ª—è —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤
  private static selectorCache = new Map<string, string>();

  static getGameCardSelector(gameTitle: string): string {
    const cacheKey = `game-card-${gameTitle}`;
    
    if (this.selectorCache.has(cacheKey)) {
      return this.selectorCache.get(cacheKey)!;
    }

    // –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–µ–ª–µ–∫—Ç–æ—Ä
    const selector = `[data-testid="game-card"][data-title="${gameTitle}"]`;
    this.selectorCache.set(cacheKey, selector);
    
    return selector;
  }

  static getLoginButtonSelector(): string {
    return '[data-testid="login-button"]';
  }

  static getGameIframeSelector(): string {
    return 'iframe[src*="game"]';
  }
}
```

#### 3.3.3. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–°–æ–∑–¥–∞—Ç—å `src/core/cache/TestDataCache.ts`:**
```typescript
export class TestDataCache {
  private static cache = new Map<string, any>();
  private static ttl = new Map<string, number>();

  static set<T>(key: string, value: T, ttlMs: number = 300000): void {
    this.cache.set(key, value);
    this.ttl.set(key, Date.now() + ttlMs);
  }

  static get<T>(key: string): T | undefined {
    const expiry = this.ttl.get(key);
    
    if (expiry && Date.now() > expiry) {
      this.cache.delete(key);
      this.ttl.delete(key);
      return undefined;
    }

    return this.cache.get(key);
  }

  static clear(): void {
    this.cache.clear();
    this.ttl.clear();
  }
}
```

---

## –ú–ï–¢–†–ò–ö–ò –£–°–ü–ï–•–ê

### –ö–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (KPI)

#### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤:** –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –Ω–∞ 60%
- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç—å:** 4 workers –≤–º–µ—Å—Ç–æ 1
- **–ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å:** 50+ —Ç–µ—Å—Ç–æ–≤ –≤ —á–∞—Å

#### –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
- **Flaky tests:** –°–Ω–∏–∂–µ–Ω–∏–µ –¥–æ 5%
- **Success rate:** –ü–æ–≤—ã—à–µ–Ω–∏–µ –¥–æ 95%
- **Retry rate:** –°–Ω–∏–∂–µ–Ω–∏–µ –¥–æ 10%

#### –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞
- **Code coverage:** –ü–æ–≤—ã—à–µ–Ω–∏–µ –¥–æ 80%
- **Cyclomatic complexity:** –°–Ω–∏–∂–µ–Ω–∏–µ –¥–æ 8
- **Code duplication:** –°–Ω–∏–∂–µ–Ω–∏–µ –¥–æ 5%

#### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å
- **Time to add new test:** –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –Ω–∞ 50%
- **Debug time:** –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –Ω–∞ 40%
- **Onboarding time:** –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –Ω–∞ 60%

---

## –ü–õ–ê–ù –í–ù–ï–î–†–ï–ù–ò–Ø

### –ù–µ–¥–µ–ª—è 1-2: –ë–∞–∑–æ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
- [ ] –†–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è –ø–∞–ø–æ–∫
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ ESLint/Prettier
- [ ] –î–æ–±–∞–≤–ª–µ–Ω–∏–µ JSDoc
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ —É—Ç–∏–ª–∏—Ç
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –ù–µ–¥–µ–ª—è 3-4: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
- [ ] Page Object Pattern
- [ ] State Management
- [ ] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –æ–∫—Ä—É–∂–µ–Ω–∏–π
- [ ] –£–º–Ω–∞—è retry –ª–æ–≥–∏–∫–∞

### –ù–µ–¥–µ–ª—è 5-6: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
- [ ] Allure Report
- [ ] –£–º–Ω—ã–µ –æ–∂–∏–¥–∞–Ω–∏—è
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- [ ] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ù–µ–¥–µ–ª—è 7-8: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- [ ] –û—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ–±–ª–µ–º
- [ ] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫
- [ ] –§–∏–Ω–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

## –†–ò–°–ö–ò –ò –ú–ò–¢–ò–ì–ê–¶–ò–Ø

### –í—ã—Å–æ–∫–∏–µ —Ä–∏—Å–∫–∏
1. **–ù–∞—Ä—É—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–µ—Å—Ç–æ–≤**
   - –ú–∏—Ç–∏–≥–∞—Ü–∏—è: –ü–æ—ç—Ç–∞–ø–Ω–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ —Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
   - –ü–ª–∞–Ω B: –û—Ç–∫–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏

2. **–°–Ω–∏–∂–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**
   - –ú–∏—Ç–∏–≥–∞—Ü–∏—è: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ
   - –ü–ª–∞–Ω B: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —É—á–∞—Å—Ç–∫–æ–≤

### –°—Ä–µ–¥–Ω–∏–µ —Ä–∏—Å–∫–∏
1. **–°–ª–æ–∂–Ω–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã**
   - –ú–∏—Ç–∏–≥–∞—Ü–∏—è: –û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ —Ç—Ä–µ–Ω–∏–Ω–≥–∏
   - –ü–ª–∞–Ω B: –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π

2. **–ü—Ä–æ–±–ª–µ–º—ã —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏**
   - –ú–∏—Ç–∏–≥–∞—Ü–∏—è: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö
   - –ü–ª–∞–Ω B: –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

---

## –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

–î–∞–Ω–Ω—ã–π –ø–ª–∞–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –æ–±–µ—Å–ø–µ—á–∏—Ç **–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ** –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞ Lucky E2E Automation. 

**–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- üöÄ **60% —É–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**
- üéØ **95% —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–æ–≤**
- üìà **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –¥–ª—è –∫–æ–º–∞–Ω–¥—ã –¥–æ 10 —á–µ–ª–æ–≤–µ–∫**
- üîß **50% —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤**

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–ª–∞–Ω–∞ –∫–æ–º–∞–Ω–¥–æ–π
2. –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö
3. –ù–∞—á–∞–ª–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –§–∞–∑—ã 1
4. –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ —Ä–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤—ã –∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏

–ü—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –ø–ª–∞–Ω –æ–±–µ—Å–ø–µ—á–∏—Ç **–¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—É—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** –ø—Ä–æ–µ–∫—Ç–∞ –∏ —Å–æ–∑–¥–∞—Å—Ç **–ø—Ä–æ—á–Ω—É—é –æ—Å–Ω–æ–≤—É** –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è.
